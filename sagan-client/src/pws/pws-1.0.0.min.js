!function(t){var e="https://run-on-pws-api.cfapps.io",n="/v1/start?",r="/v1/user/",o="/v1/app/",s="/v1/tokenStatus/",i="https://run-on-pws-api.cfapps.io/img/run-on-pws-button.png",a="PWS_TOKEN",u="PWS_STATE",c="connected",l=document,p=encodeURIComponent,f=decodeURIComponent,d=function(e,n,r,o){o=t.XMLHttpRequest?new XMLHttpRequest:new t.ActiveXObject("Microsoft.XMLHTTP"),o.open(r?"POST":"GET",e,1),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),r&&(o.setRequestHeader("Content-type","application/json"),r=JSON.stringify(r)),o.onreadystatechange=function(){if(o.readyState>3&&n){var t=o.responseText;try{n(JSON.parse(t),o)}catch(e){n(t,o)}}else;},o.send(r)},g=function(t,r){return e+n+"client_id="+p(t)+"&redirect_uri="+p(r)},v=function(t,n){return e+r+t+"/"+n+"/"},h=function(t){return e+s+t},M=function(t){return e+o+t+"/status"},S=function(t){return e+o+t+"/route"},w=function(t){return e+o+t+"/console"},L=function(){for(var t={},e=location.hash.substr(1).split("&"),n=e.length-1;n>=0;n--){var r=e[n].split("="),o=f(r[0]);t[o]=f(r[1])}return t},m=function(t,e){d(h(t),e)},T=function(t){t=t.toLowerCase();for(var e=l.cookie.split(";"),n=e.length-1;n>=0;n--){var r=e[n].split("="),o=f(r[0].trim().toLowerCase()),s=o.length>1?o[1]:"";if(t===o)return f(s)}return""},k=function(t,e){var n=new Date;n.setFullYear(n.getFullYear()+1);var r=p(t)+"="+p(e)+";expires="+n.toGMTString()+";path=/";l.cookie=r},y=function(t){k(t,"")},R=function(e){var n=[];return e&&(n=l.querySelectorAll(e)),{deployButton:function(e){if(e.clientId&&e.redirectUrl)for(var r=function(){var n=g(e.clientId,e.redirectUrl);t.location=n},o=n.length-1;o>=0;o--)n[o].innerHTML='<img src="'+i+'" />',n[o].addEventListener("click",r,!1)}}};t.PWS={ui:function(t){new Image(i);l.addEventListener("DOMContentLoaded",function(){t.call(null,R)})},getLoginStatus:function(t){var e=L(),n={};if(e.state&&e.access_token)n.state=e.state,n.token=e.access_token,n.status=c,k(u,e.state),k(a,e.access_token),t.call(null,n);else{var r=T(u),o=T(a);r&&o?m(o,function(e){e.authenticated?(n.state=r,n.token=o,n.status=c,t.call(null,n)):(y(u),y(a),t.call(null,n))}):t.call(null,n)}},getUserInfo:function(t,e,n,r){t&&e&&n?d(v(t,e)+"?deploy_plan="+n,r):r.call(null,{errorMsg:"Missing parameters"})},getAppStatus:function(t,e){t?d(M(t),e):e.call(null,{errorMsg:"Missing parameters"})},getAppConsole:function(t){return w(t)},getAppRoute:function(t){return S(t)},push:function(t,e,n,r){t&&e&&n.deployPlan?d(v(t,e),r,n):r.call(null,{errorMsg:"Missing parameters"})}}}(window);